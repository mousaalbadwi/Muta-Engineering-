@using System.Globalization
@{
    var isRtl = CultureInfo.CurrentUICulture.TextInfo.IsRightToLeft;
    var currentController = (string)ViewContext.RouteData.Values["controller"] ?? "";
    var currentAction = (string)ViewContext.RouteData.Values["action"] ?? "";
}
<!DOCTYPE html>
<html lang="@CultureInfo.CurrentUICulture.Name" dir="@(isRtl ? "rtl" : "ltr")">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"] - MutaEngineering</title>

    @if (isRtl)
    {
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" />
    }
    else
    {
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    }

    <link rel="icon" type="image/jpeg" href="~/img/logo.jpg" sizes="32x32" asp-append-version="true" />
    <link rel="icon" type="image/jpeg" href="~/img/logo.jpg" sizes="16x16" asp-append-version="true" />
    <link rel="apple-touch-icon" href="~/img/logo.jpg" asp-append-version="true" />
    <meta name="theme-color" content="#0d6efd" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />

    @RenderSection("Styles", required: false)
</head>

<body class="bg-light d-flex flex-column min-vh-100">
    <!-- NAVBAR -->
    <header class="navbar-glass">
        <nav class="navbar navbar-expand-lg container">
            <a class="navbar-brand brand-wrap d-flex align-items-center gap-2" asp-controller="Home" asp-action="Index">
                <img src="~/img/logo.jpg" alt="Mutah University Logo" asp-append-version="true" />
                <span>@(isRtl ? "كلية الهندسة – جامعة مؤتة" : "Faculty of Engineering – Mutah University")</span>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
                    aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div id="mainNav" class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto nav-underline">
                    <li class="nav-item">
                        <a class="nav-link @(currentController=="Home" && currentAction=="Index" ? "active" : "")"
                           asp-controller="Home" asp-action="Index">
                            @(isRtl ? "الرئيسية" : "Home")
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link @(currentController == "Home" && currentAction == "Privacy" ? "active" : "")"
                           asp-controller="Home" asp-action="Privacy">
                            Privacy
                        </a>
                    </li>
                </ul>

                <div class="d-flex">
                    <div class="lang-switch">
                        <a href="?culture=ar-JO&ui-culture=ar-JO"
                           class="lang-pill @(isRtl ? "active" : "")" title="Arabic">
                            <span class="lang-flag">🇯🇴</span> عربي
                        </a>
                        <a href="?culture=en-US&ui-culture=en-US"
                           class="lang-pill @(!isRtl ? "active" : "")" title="English">
                            <span class="lang-flag">🇺🇸</span> English
                        </a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- MAIN -->
    <main class="flex-fill main-padding">
        @RenderBody()
    </main>

    <!-- FOOTER -->
    <footer class="site-footer mt-auto">
        <div class="container footer-grid">
            <div>
                <h6 class="fw-bold mb-2">
                    @(
                                        isRtl ? "كلية الهندسة – جامعة مؤتة" : "Faculty of Engineering – Mutah University")
                </h6>
                <p class="footer-meta">
                    @(
                                        isRtl ? "بوابتك الرسمية للأقسام، الخطط الدراسية، أعضاء هيئة التدريس، والمختبرات."
                                        : "Your official portal for departments, study plans, faculty members, and laboratories.")
                </p>
                <p class="footer-meta mb-0">&copy; @DateTime.Now.Year — Mutah University</p>
            </div>

            <div>
                <h6 class="fw-bold mb-2">@((isRtl ? "روابط سريعة" : "Quick Links"))</h6>
                <ul class="list-unstyled">
                    <li><a class="footer-link" asp-controller="Home" asp-action="Index">@((isRtl ? "الرئيسية" : "Home"))</a></li>
                    <li><a class="footer-link" asp-controller="Departments" asp-action="Index">@((isRtl ? "الأقسام" : "Departments"))</a></li>
                    <li><a class="footer-link" asp-controller="StudyPlans" asp-action="Index">@((isRtl ? "الخطط الدراسية" : "Study Plans"))</a></li>
                    <li><a class="footer-link" asp-controller="Home" asp-action="Privacy">@((isRtl ? "الخصوصية" : "Privacy"))</a></li>
                </ul>
            </div>

            <div>
                <h6 class="fw-bold mb-2">@((isRtl ? "تواصل معنا" : "Contact Us"))</h6>
                <ul class="list-unstyled">
                    <li>
                        <i class="bi bi-telephone me-1"></i>
                        <a class="footer-link" href="tel:+962123456789">+962 1 234 567 89</a>
                    </li>
                    <li>
                        <i class="bi bi-envelope me-1"></i>
                        <a class="footer-link" href="mailto:engineering@mutah.edu.jo">engineering@mutah.edu.jo</a>
                    </li>
                    <li><i class="bi bi-geo-alt me-1"></i>@(isRtl ? "الكرك - الأردن" : "Karak, Jordan")</li>
                </ul>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        // ظل عند التمرير
        (function () {
          const h = document.querySelector('.navbar-glass');
          const onScroll = () => h?.classList.toggle('scrolled', window.scrollY > 4);
          document.addEventListener('scroll', onScroll, { passive: true });
          onScroll();
        })();

        // اتجاه حركة الـ underline (يسار/يمين)
        document.querySelectorAll('.nav-underline .nav-link').forEach(link => {
          link.addEventListener('mouseenter', e => {
            const r = e.currentTarget.getBoundingClientRect();
            const x = e.clientX - r.left;
            const origin = x < r.width / 2 ? 'left' : 'right';
            e.currentTarget.style.setProperty('--x-origin', origin);
          });
        });
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
